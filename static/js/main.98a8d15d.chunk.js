(this.webpackJsonpchronicles=this.webpackJsonpchronicles||[]).push([[0],{2:function(e,t){e.exports={MOUNTAIN_ICE:"MOUNTAIN_ICE",MOUNTAIN:"MOUNTAIN",HILL_ICE:"HILL_ICE",HILL:"HILL",HILL_SOIL:"HILL_SOIL",HILL_SWAMP:"HILL_SWAMP",HILL_GRASS:"HILL_GRASS",HILL_SAND:"HILL_SAND",PLAIN_ICE:"PLAIN_ICE",PLAIN_SWAMP:"PLAIN_SWAMP",PLAIN_FOREST:"PLAIN_FOREST",PLAIN_GRASS:"PLAIN_GRASS",PLAIN_SAND:"PLAIN_SAND",PLAIN_MARSH:"PLAIN_MARSH",PLAIN_SOIL:"PLAIN_SOIL",PLAIN:"PLAIN",WATER:"WATER",WATER_ICE:"WATER_ICE",OCEAN:"OCEAN",OCEAN_ICE:"OCEAN_ICE"}},58:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(27),o=n(10),c=n(6),s=n(5),l=n(3),u=n(4),d=n(28),h=n.n(d),f=n(20),v=n.n(f),g=n(14),m=n(13),b=n(12),y=n(9),j=function(){function e(t){Object(l.a)(this,e);var n=t.x,r=t.y,a=t.world,i=t.icon,o=t.color,c=t.backgroundColor;this._x=n,this._y=r,this._icon=i,this._world=a,this._color=o,this._backgroundColor=c,this._world.registerMapEntity(this)}return Object(u.a)(e,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"icon",get:function(){return this._icon}},{key:"color",get:function(){return this._color}},{key:"backgroundColor",get:function(){return this._backgroundColor}},{key:"ui",get:function(){return{icon:this._icon,color:this._color,backgroundColor:this._backgroundColor}}},{key:"getDistance",value:function(e,t){return Math.sqrt(Math.pow(e-this._x,2)+Math.pow(t-this._y,2))}}]),e}(),p=function(){function e(t){Object(l.a)(this,e);var n=t.type,r=t.entity;this._type=n,this._events={},this._entity=r}return Object(u.a)(e,[{key:"type",get:function(){return this._type}},{key:"entity",get:function(){return this._entity}},{key:"id",get:function(){return this._entity.id}},{key:"label",get:function(){return this._entity.name}},{key:"years",get:function(){return Object.keys(this._events)}},{key:"getYear",value:function(e){var t=this._events[e];return null==t?[]:t.map((function(e){var t=e.actors.reduce((function(e,t,n){return e.replaceAll("{".concat(n,"}"),t.label)}),e.description);return{event:e,description:t}}))}},{key:"add",value:function(e){var t=this._events[e.year];null==t&&(t=this._events[e.year]=[]),t.push(e)}}]),e}(),_=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,{entity:e,type:"town"})}return Object(u.a)(n)}(p),O=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,{entity:e,type:"road"})}return Object(u.a)(n)}(p),x=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,{entity:e,type:"culture"})}return Object(u.a)(n)}(p),w=function(){function e(){Object(l.a)(this,e),this._events={},this._actors={}}return Object(u.a)(e,[{key:"events",get:function(){return Object(c.a)({},this._events)}},{key:"years",get:function(){return Object.keys(this._events)}},{key:"getActor",value:function(e,t){return null==this._actors[e]?null:this._actors[e][t]}},{key:"registerActors",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map((function(t){var n=e._actors[t.type];return null==n&&(n=e._actors[t.type]={}),null==n[t.id]&&(n[t.id]=t),n[t.id]}))}},{key:"getYear",value:function(e){var t=this._events[e];return null==t?[]:t.map((function(e){var t=e.actors.reduce((function(e,t,n){return e.replaceAll("{".concat(n,"}"),t.label)}),e.description);return{event:e,description:t}}))}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this._events[e];null==r&&(r=this._events[e]=[]);var a=this.registerActors.apply(this,Object(s.a)(n)),i={year:e,actors:a,description:t};r.push(i),a.forEach((function(e){return e.add(i)}))}}]),e}(),k=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,{entity:e,type:"adventurer"})}return Object(u.a)(n,[{key:"label",get:function(){return this._entity.fullName}}]),n}(p);var A=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(l.a)(this,n),e=t.call(this,Object(c.a)({icon:"\u25d9",color:"orange",backgroundColor:"#222",world:r.culture.world},r));var a=r.culture;return e._culture=a,e._id=e.random.guid(),e._adventurers=[],e._creation=e.world.year,e._name=new g.Name({seed:e._id}),e._settings={youths:15},e._titles={governor:null},e._cache={alive:[]},e}return Object(u.a)(n,[{key:"id",get:function(){return this._id}},{key:"culture",get:function(){return this._culture}},{key:"world",get:function(){return this._culture.world}},{key:"random",get:function(){return this.world.random}},{key:"name",get:function(){return this._name.toString()}},{key:"creation",get:function(){return this._creation}},{key:"adventurers",get:function(){return Object(s.a)(this._cache.alive)}},{key:"titles",get:function(){return Object(c.a)({},this._titles)}},{key:"governor",get:function(){return this._titles.governor},set:function(e){this._titles.governor=e}},{key:"killAdventurers",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){var n=e._cache.alive.indexOf(t);-1!==n&&e._cache.alive.splice(n,1)}))}},{key:"addAdventurers",value:function(){for(var e,t,n=this,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];(e=this._adventurers).push.apply(e,a),(t=this._cache.alive).push.apply(t,Object(s.a)(a.filter((function(e){return e.isAlive(n.world.year)}))))}},{key:"createAdventurers",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n.map((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e._culture.createAdventurer(Object(c.a)({},t))}));return this.addAdventurers.apply(this,Object(s.a)(a)),a}},{key:"tick",value:function(){var e;(e=this).creation+3<=e.world.year||e.createAdventurers.apply(e,Object(s.a)(Array(e.random.integer({min:9,max:11})).fill().map((function(){return{birth:e._world.year-e.random.integer({min:18,max:26})}})))).forEach((function(t){e.world.addEvent("{0} settled in {1}",[new k(t),new _(e)])})),function(e){var t=e.adventurers.reduce((function(t,n){return n.getAge(e.world.year)<35&&(t.youths+=1),null==n.spouse||n.gender!==y.genders.FEMALE||Math.min.apply(Math,Object(s.a)(n.children.map((function(t){return t.getAge(e.world.year)}))))>2&&t.wifes.push(n),t}),{wifes:[],youths:0}),n=t.wifes,r=t.youths;n.sort((function(e,t){return e.children.length-t.children.length}));var a=e.random.integer({min:0,max:Math.max(0,Math.min(n.length,e._settings.youths-r))});n.slice(0,a).forEach((function(t){var n=t.spouse,r=t.reproduce(n,{birth:e.world.year});e.addAdventurers(r),e.world.addEvent("{0} and {1} had a child who they named {2} in {3}",[new k(n),new k(t),new k(r),new _(e)])}))}(this),function(e){var t=e.adventurers.reduce((function(t,n){return null!=n.spouse&&!0===n.spouse.isAlive(e.world.year)||n.getAge(e.world.year)<18||t[n.gender===y.genders.MALE?"males":"females"].push(n),t}),{males:[],females:[]}),n=t.males,r=t.females,a=n.length>r.length?n:r,i=a===r?n:r,c=e.random.integer({min:0,max:Math.ceil(a.length/2)});e.random.shuffle(a).slice(0,c).forEach((function(t){var n=e.random.shuffle(i).find((function(e){return!1===t.extendedFamily.includes(e)&&!1===e.extendedFamily.includes(t)}));if(null==n){var r=e.createAdventurers({gender:t.gender!==y.genders.MALE?y.genders.MALE:y.genders.FEMALE,birth:e.world.year-e.random.integer({min:18,max:26})});n=Object(o.a)(r,1)[0]}var a=i.indexOf(n);-1!==a&&i.splice(a,1),t.spouse=n,e.world.addEvent("{0} married {1} in {2}",[new k(t),new k(n),new _(e)])}))}(this),function(e){var t=e.adventurers.filter((function(t){return!1===t.isAlive(e.world.year)}));e.killAdventurers.apply(e,Object(s.a)(t)),t.forEach((function(t){e.titles.governor===t?e.world.addEvent("Governor {0} of {1} died",[new k(t),new _(e)]):e.world.addEvent("{0} died in {1}",[new k(t),new _(e)])}))}(this),function(e){var t=e.adventurers;if(null==e.governor&&(e.governor=e.random.pickone(t.filter((function(t){return t.getAge(e.world.year)>18}))),e.world.addEvent("{0} was given the position of Governor of {1}",[new k(e.governor),new _(e)])),!0!==e.governor.isAlive(e.world.year)){var n=e.governor.children.filter((function(t){return t.isAlive(e.world.year)})).sort((function(t,n){return n.getAge(e.year)-t.getAge(e.year)}))[0];null==n&&(n=e.governor.extendedFamily.filter((function(t){return t.isAlive(e.world.year)})).sort((function(t,n){return n.getAge(e.year)-t.getAge(e.year)}))[0]),0!==t.length&&(null==n&&(n=e.random.pickone(t)),e.governor=n,e.world.addEvent("{0} was given the position of Governor of {1}",[new k(e.governor),new _(e)]))}}(this)}}]),n}(j);var I=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(e){var r;Object(l.a)(this,n),r=t.call(this,Object(c.a)({seed:e.world.random.guid()},e));var a=e.world;return r._towns=[],r._world=a,r._titles={king:null},r}return Object(u.a)(n,[{key:"world",get:function(){return this._world}},{key:"random",get:function(){return this.world.random}},{key:"towns",get:function(){return this._towns}},{key:"adventurers",get:function(){return this._towns.reduce((function(e,t){return e.push.apply(e,Object(s.a)(t.adventurers)),e}),[])}},{key:"titles",get:function(){return Object(c.a)({},this._titles)}},{key:"king",get:function(){return this._titles.king},set:function(e){this._titles.king=e}},{key:"createTowns",value:function(){for(var e,t=this,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=r.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null!=e.x||null!=e.y?{x:e.x,y:e.y}:t.world.getHabitableCoords(),r=n.x,a=n.y,i=new A(Object(c.a)(Object(c.a)({x:r,y:a},e),{},{culture:t}));return i}));return(e=this._towns).push.apply(e,Object(s.a)(i)),i}},{key:"tick",value:function(){!function(e){var t=e.adventurers;if(0!==t.length&&(null==e.king&&(e.king=e.random.pickone(t.filter((function(t){return t.getAge(e.world.year)>18}))),e.world.addEvent("King {0} ascended the thrown of {1}",[new k(e.king),new x(e)])),!0!==e.king.isAlive(e.world.year))){var n=e.king.children.filter((function(t){return t.isAlive(e.world.year)})).sort((function(t,n){return n.getAge(e.year)-t.getAge(e.year)}))[0];null==n&&(n=e.king.extendedFamily.filter((function(t){return t.isAlive(e.world.year)})).sort((function(t,n){return n.getAge(e.year)-t.getAge(e.year)}))[0]),0!==t.length&&(null==n&&(n=e.random.pickone(t)),e.king=n,e.world.addEvent("King {0} ascended the thrown of {1}",[new k(e.king),new x(e)]))}}(this),function(e){if(!(e.towns.length>0)){var t=e.createTowns({culture:e}),n=Object(o.a)(t,1)[0];e.world.addEvent("The people of {0} founded {1}",[new x(e),new _(n)])}}(this),function(e){if(!0!==e.random.bool({likelihood:80}))e:for(var t=0;t<4;t++){for(var n=Object(o.a)(e.towns,1)[0],r=Math.floor(2),a=e.world.getHabitableCoords({fromX:Math.max(0,n.x-4),fromY:Math.max(0,n.y-4),toX:Math.min(e.world.width,n.x+4),toY:Math.min(e.world.height,n.y+4)}),i=a.x,c=a.y,s=Math.max(0,i-r),l=Math.max(0,c-r),u=Math.min(e.world.width,i+r),d=Math.min(e.world.height,c+r),h=l;h<d;h++)for(var f=s;f<u;f++)if(null!=e.world.getMapEntityAt(f,h))continue e;var v=e.createTowns({x:i,y:c,culture:e}),g=Object(o.a)(v,1)[0];e.world.addEvent("{0} , a {1} settlment, has been founded by people from {2}",[new _(g),new x(e),new _(n)]);var m=e.world.createRoad(n,g);e.world.addEvent("{0} is now connecting {1} and {0}",[new O(m),new _(n),new _(g)]);break}}(this),this._towns.forEach((function(e){e.tick()}))}}]),n}(y.Culture),L=n(2),N=n.n(L);var C=n(11),E=n.n(C),M=function(){function e(t){Object(l.a)(this,e);var n=t.x,r=t.y,a=t.random,i=t.sand,o=void 0===i?0:i,c=t.rainfall,s=void 0===c?0:c,u=t.elevation,d=void 0===u?0:u,h=t.vegetation,f=void 0===h?0:h,v=t.temperature,g=void 0===v?0:v;this._={x:n,y:r,sand:o,random:a,rainfall:s,elevation:d,vegetation:f,temperature:g}}return Object(u.a)(e,[{key:"id",get:function(){return"".concat(this.x,"-").concat(this.y)}},{key:"x",get:function(){return this._.x}},{key:"y",get:function(){return this._.y}},{key:"sand",get:function(){return this._.sand}},{key:"rainfall",get:function(){return this._.rainfall}},{key:"elevation",get:function(){return this._.elevation}},{key:"vegetation",get:function(){return this._.vegetation}},{key:"temperature",get:function(){return this._.temperature}},{key:"random",get:function(){return this._.random}},{key:"type",get:function(){return this.elevation>.9?this.temperature<.4&&this.rainfall>.6?N.a.MOUNTAIN_ICE:N.a.MOUNTAIN:this.elevation>.8?this.temperature<.4?this.rainfall>.6?N.a.HILL_ICE:N.a.HILL:this.rainfall>.8?N.a.HILL_SWAMP:this.rainfall>.4?this.vegetation>.6?N.a.HILL_GRASS:N.a.HILL_SOIL:this.sand>.7?N.a.HILL_SAND:N.a.HILL:this.elevation>.5?this.temperature<.4?this.rainfall>.6?N.a.PLAIN_ICE:N.a.PLAIN:this.rainfall>.8?this.vegetation>.8?N.a.PLAIN_SWAMP:N.a.PLAIN_MARSH:this.rainfall>.4?this.vegetation>.8?N.a.PLAIN_FOREST:this.vegetation>.3?N.a.PLAIN_GRASS:N.a.PLAIN_SOIL:this.sand>.7?N.a.PLAIN_SAND:N.a.PLAIN:this.elevation>.4?this.temperature>.4?N.a.WATER:N.a.WATER_ICE:this.temperature>.4?N.a.OCEAN:N.a.OCEAN_ICE}},{key:"ui",get:function(){var e={};switch(this.type){case N.a.MOUNTAIN_ICE:e={icon:"\u2302",color:"#FFFFFF",backgroundColor:"#222"};break;case N.a.MOUNTAIN:e={icon:"\u2302",color:"#aaa",backgroundColor:"#222"};break;case N.a.HILL_ICE:e={icon:"\u2229",color:"#FFFFFF",backgroundColor:"#222"};break;case N.a.HILL:var t=this.random.pickone(["#444","#333"]);e={icon:"\u2229",color:E()(t).lighten(1.5).hex(),backgroundColor:t};break;case N.a.HILL_SOIL:var n=this.random.pickone(["#1e1a15","#27221b"]);e={icon:"\u2229",color:E()(n).lighten(1.5).hex(),backgroundColor:n};break;case N.a.HILL_SWAMP:var r=this.random.pickone(["#1b2413","#192211"]);e={icon:"\u2229",color:E()(r).lighten(1.5).hex(),backgroundColor:r};break;case N.a.HILL_GRASS:var a=this.random.pickone(["#2d3a22","#25301c"]);e={icon:"\u2229",color:E()(a).lighten(1.5).hex(),backgroundColor:a};break;case N.a.HILL_SAND:var i=this.random.pickone(["#483c1a","#392f14"]);e={icon:"\u2229",color:E()(i).lighten(1.5).hex(),backgroundColor:i};break;case N.a.PLAIN_ICE:var o=this.random.pickone(["#888","#999"]);e={icon:"\u2248",color:E()(o).lighten(1.5).hex(),backgroundColor:o};break;case N.a.PLAIN_SWAMP:var c=this.random.pickone(["#1b2413","#192211"]);e={icon:this.random.pickone(['"',"\u2320"]),color:E()(c).lighten(1.5).hex(),backgroundColor:c};break;case N.a.PLAIN_MARSH:var s=this.random.pickone(["#151a0f","#171f0f"]);e={icon:this.random.pickone(['"',"\u207f"]),color:E()(s).lighten(1.5).hex(),backgroundColor:s};break;case N.a.PLAIN_FOREST:var l=this.random.pickone(["#2d3a22","#25301c"]);e={icon:this.random.pickone(["\u2660","\u2663","\u2191"]),color:E()(l).lighten(1.5).hex(),backgroundColor:l};break;case N.a.PLAIN_GRASS:var u=this.random.pickone(["#2d3a22","#25301c"]);e={icon:this.random.pickone(["\u207f","."]),color:E()(u).lighten(1.5).hex(),backgroundColor:u};break;case N.a.PLAIN_SOIL:var d=this.random.pickone(["#1e1a15","#27221b"]);e={icon:this.random.pickone(["\u207f","."]),color:E()(d).lighten(1.5).hex(),backgroundColor:d};break;case N.a.PLAIN_SAND:var h=this.random.pickone(["#483c1a","#392f14"]);e={icon:"\u2248",color:E()(h).lighten(1.5).hex(),backgroundColor:h};break;case N.a.PLAIN:var f=this.random.pickone(["#444","#555"]);e={icon:".",color:E()(f).lighten(1.5).hex(),backgroundColor:f};break;case N.a.WATER:e={icon:"~",color:"#35506f",backgroundColor:"#1d2d3f"};break;case N.a.WATER_ICE:e={icon:this.random.pickone(["\u2592","\u2591"]),color:"#35506f",backgroundColor:"#1d2d3f"};break;case N.a.OCEAN:e={icon:"\u2248",color:"#304177",backgroundColor:"#172331"};break;case N.a.OCEAN_ICE:e={icon:this.random.pickone(["\u2592","\u2591"]),color:"#35506f",backgroundColor:"#1d2d3f"};break;default:e={icon:this.random.pickone(["X"]),color:"#ff00d4",backgroundColor:"#ff00d4"}}return e}}]),e}(),S=n(29),T=n(30);function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.seed,n=e.width,r=e.height,a=e.octaves,i=void 0===a?10:a,o=e.amplitude,c=void 0===o?1:o,s=e.frequency,l=void 0===s?.025:s,u=e.persistence,d=void 0===u?.5:u,h=Object(S.makeRectangle)(n,r,Object(T.makeNoise2D)(t),{octaves:i,amplitude:c,frequency:l,persistence:d});return function(e,t){return h[e][t]+.5}}function P(e){var t=e.seed,n=e.width,r=e.height,a=e.random,i={},o=H({width:n,height:r,seed:10*t}),c=H({width:n,height:r,seed:20*t}),s=H({width:n,height:r,seed:30*t}),l=H({width:n,height:r,seed:40*t}),u=function(e){var t=e.seed,n=e.size,r=e.width,a=e.height,i=e.position,o=H({seed:t,width:r,height:a});return function(e,t){var r=i-n,c=i+n;return t>=r&&t<=c?1:(t<r?t/r:1-(t-c)/(a-c))-o(e,t)/2}}({width:n,height:r,seed:50*t,size:Math.floor(.4*r),position:a.integer({min:Math.floor(.4*r),max:Math.floor(.6*r)})});return function(e,t){var n="".concat(e,"=").concat(t);return null!=i[n]||(i[n]=new M({x:e,y:t,random:a,sand:o(e,t),rainfall:c(e,t),elevation:s(e,t),vegetation:l(e,t),temperature:u(e,t)})),i[n]}}var D=function(){function e(t){Object(l.a)(this,e);var n=t.world,r=t.coordinates;this._world=n,this._id=this.random.guid(),this._coordinates=r,this._name=new g.Name({seed:this._id}),this._type=this.random.pickone(["Road","Street","Way","Avenue","Lane","Grove"])}return Object(u.a)(e,[{key:"world",get:function(){return this._world}},{key:"random",get:function(){return this._world.random}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return"".concat(this._name," ").concat(this._type)}},{key:"coordinates",get:function(){return Object(s.a)(this._coordinates)}}]),e}(),R=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(l.a)(this,e);var r=n.seed,a=n.canvas,i=n.offset,o=void 0===i?15:i,c=n.onTownSelection;this._random=new v.a(r),this._id=this._random.guid(),this._roads=[],this._year=1e3,this._cultures=[],this._chronicles=new w,this._name=new g.Name({seed:this._id}),this._offset=o,this._canvas=a,this._random=new v.a(r),this._onTownSelection=c,this._context=F(a,(function(e,n){return t.handleClick(e,n)})),this.getTile=P({seed:r,width:this.width,height:this.height,random:this._random}),this._cache={mapEntities:{}}}return Object(u.a)(e,[{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name.toString()}},{key:"random",get:function(){return this._random}},{key:"cultures",get:function(){return Object(s.a)(this._cultures)}},{key:"roads",get:function(){return Object(s.a)(this._roads)}},{key:"width",get:function(){return Math.floor(this._canvas.width/this._offset)}},{key:"height",get:function(){return Math.floor(this._canvas.height/this._offset)}},{key:"year",get:function(){return this._year}},{key:"chronicles",get:function(){return this._chronicles}},{key:"getMapEntityAt",value:function(e,t){return this._cache.mapEntities["".concat(e,":").concat(t)]}},{key:"registerMapEntity",value:function(e){if(null!=this.getMapEntityAt(e.x,e.y))throw new Error("coordinates already occupied");this._cache.mapEntities["".concat(e.x,":").concat(e.y)]=e}},{key:"getHabitableCoords",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null==e.fromX?0:Math.max(0,e.fromX),n=null==e.fromY?0:Math.max(0,e.fromY),r=null==e.toX?this.width-1:Math.min(this.width-1,e.toX),a=null==e.toY?this.height-1:Math.min(this.height-1,e.toY),i=0;i<10;){var o=this._random.integer({min:t,max:r}),c=this._random.integer({min:n,max:a});if(null==this.getMapEntityAt(o,c)){var s=this.getTile(o,c);if(!0!==[N.a.WATER,N.a.OCEAN,N.a.OCEAN_ICE,N.a.WATER_ICE,N.a.MOUNTAIN_ICE].includes(s.type))return{x:o,y:c}}}return null}},{key:"handleClick",value:function(e,t){var n=Math.floor(e/this._offset),r=Math.floor(t/this._offset),a=Object.values(this._cache.mapEntities).reduce((function(e,t){return t.getDistance(n,r)>1?e:null==e||e.getDistance(n,r)>t.getDistance(n,r)?t:e}),null);null!=a&&this._onTownSelection(this._chronicles.getActor("town",a.id))}},{key:"addEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this._chronicles.add(this._year,e,t)}},{key:"createRoad",value:function(e,t){for(var n=this,r=Math.max(e.x,t.x),a=Math.min(e.x,t.x),i=Math.max(e.y,t.y),o=[],c=Math.min(e.y,t.y);c<=i;c++)for(var s=a;s<=r;s++){var l=this.getTile(s,c);o.push({x:s,y:c,weight:l.type===N.a.MOUNTAIN_ICE||l.type===N.a.MOUNTAIN?.9:l.type===N.a.HILL_ICE?.7+this._random.floating({min:0,max:.4}):l.type===N.a.HILL?.5+this._random.floating({min:0,max:.6}):l.type===N.a.HILL_SWAMP?.7+this._random.floating({min:0,max:.4}):l.type===N.a.HILL_GRASS||l.type===N.a.HILL_SOIL?.6+this._random.floating({min:0,max:.5}):l.type===N.a.HILL_SAND?.8+this._random.floating({min:0,max:.3}):l.type===N.a.PLAIN_ICE?.4+this._random.floating({min:0,max:.7}):l.type===N.a.PLAIN_SWAMP?.6+this._random.floating({min:0,max:.5}):l.type===N.a.PLAIN_FOREST?.5+this._random.floating({min:0,max:.6}):l.type===N.a.PLAIN_GRASS||l.type===N.a.PLAIN_SOIL?.4+this._random.floating({min:0,max:.7}):l.type===N.a.PLAIN_SAND||l.type===N.a.PLAIN_MARSH?.6+this._random.floating({min:0,max:.5}):l.type===N.a.PLAIN?.4+this._random.floating({min:0,max:.6}):l.type===N.a.WATER?1:l.type===N.a.WATER_ICE?.9+this._random.floating({min:0,max:.2}):l.type===N.a.OCEAN?1:l.type===N.a.OCEAN_ICE?.9+this._random.floating({min:0,max:.2}):1})}var u=h()(o)(e,t,{diagonals:!1,calculateG:function(e,t){var r=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),a=n.getTile(e.x,e.y),i=n.getTile(t.x,t.y);return r+Math.abs(a.elevation-i.elevation)}}).reverse();u.pop(),u.splice(0,1);var d=new D({coordinates:u,world:this});return this._roads.push(d),d}},{key:"createCultures",value:function(){for(var e,t=this,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i=r.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=new I(Object(c.a)(Object(c.a)({},e),{},{world:t}));return n}));return(e=this._cultures).push.apply(e,Object(s.a)(i)),i}},{key:"draw",value:function(){for(var e=0;e<this.height;e++)for(var t=0;t<this.width;t++){var n=this.getTile(t,e),r=t*this._offset,a=e*this._offset,i=this.getMapEntityAt(t,e),o=null==i?n.ui:i.ui;this._context.fillStyle=o.backgroundColor,this._context.fillRect(r-8,a-9,20,20),this._context.fillStyle=o.color,this._context.fillText(o.icon,r,a)}!function(e){var t=e.offset,n=e.context,r=e.coordinates;[{width:2,color:e.color}].forEach((function(e){n.strokeStyle=e.color,n.lineWidth=e.width,r.forEach((function(e){n.beginPath(),e.forEach((function(e){n.lineTo(e.x*t,e.y*t-2)})),n.stroke()}))}))}({color:"#978169",offset:this._offset,context:this._context,coordinates:this._roads.map((function(e){return e.coordinates}))})}},{key:"tick",value:function(){var e;this._year+=1,(e=this).cultures.length>4||e.createCultures.apply(e,Object(s.a)(Array(e.random.integer({min:0,max:2})).fill().map((function(){return{seed:e.random.guid()}})))).forEach((function(t){e.addEvent("The people of {0} started writing history",[new x(t)])})),this._cultures.forEach((function(e){e.tick()}))}}]),e}();function F(e,t){var n=e.getContext("2d");return n.textAlign="center",n.font="10px monospace",n.lineCap="round",n.lineJoin="round",e.addEventListener("click",(function(n){!function(n){var r=e.getBoundingClientRect(),a=n.clientX-r.left,i=n.clientY-r.top;t(a,i)}(n)})),n}var W=a.a.createContext(),G=(n(58),n(0));function U(){var e=a.a.useContext(W).world,t=a.a.useState(null==e?0:e.year),n=Object(o.a)(t,2),r=n[0],i=n[1],c=a.a.useCallback((function(){null!=e&&(Array(5).fill().forEach((function(){e.tick(),i(e.year)})),e.draw())}),[e]);return a.a.useEffect((function(){c()}),[c]),null!=e&&Object(G.jsxs)("div",{className:"AppTime",children:[Object(G.jsx)("strong",{children:e.name}),Object(G.jsxs)("div",{children:["Year: ",r]}),Object(G.jsx)("button",{onClick:c,className:"AppTimeTicker",children:"Proceed"})]})}var Y=a.a.memo(U);n(60);function X(e){var t=e.tabs,n=void 0===t?[]:t,r=a.a.useState(0),i=Object(o.a)(r,2),c=i[0],s=i[1],l=a.a.useMemo((function(){return n.map((function(e,t){var n=["TabsNavigationItem"];return t===c&&n.push("TabsNavigationItem--Active"),Object(G.jsx)("li",{tabIndex:0,role:"button",className:n.join(" "),onClick:function(){return s(t)},children:e.label})}))}),[n,c]),u=a.a.useMemo((function(){return n[c].content}),[n,c]);return Object(G.jsxs)("div",{className:"Tabs",children:[Object(G.jsx)("nav",{children:Object(G.jsx)("ul",{className:"TabsNavigation",children:l})}),Object(G.jsx)("div",{className:"TabsContent",children:u})]})}var q=a.a.memo(X);n(61);function z(e){var t=e.type,n=e.actorID,r=a.a.useContext(W),i=r.world,o=r.setSelectedActorInfo,c=a.a.useMemo((function(){return i.chronicles.getActor(t,n)}),[t,i,n]),s=a.a.useCallback((function(){o({type:t,entity:c})}),[t,c,o]);return Object(G.jsx)("span",{onClick:s,className:"Actor",children:c.label})}var B=a.a.memo(z);n(62);function J(e){var t=e.width,n=void 0===t?"500px":t,r=e.onClose,i=a.a.useCallback((function(){"function"===typeof r&&r.apply(void 0,arguments)}),[r]);return Object(G.jsx)("div",{role:"dialog",className:"Dialog",children:Object(G.jsxs)("div",{style:{width:n},className:"DialogContainer",children:[Object(G.jsx)("div",{tabIndex:0,role:"button",onClick:i,"aria-label":"Close Dialog",className:"DialogContainerClose",children:"x"}),e.children]})})}var K=a.a.memo(J);function Q(e){var t=e.town,n=a.a.useMemo((function(){return t.entity.adventurers.map((function(e){return Object(G.jsxs)("li",{children:[Object(G.jsx)(B,{type:"adventurer",actorID:e.id}),e.getAge(t.entity.world.year)<18&&" \u263a ",e.gender===y.genders.MALE?" \u2642 ":" \u2640 ",e.getAge(t.entity.world.year)]})}))}),[t]);return Object(G.jsx)("ul",{children:n})}var V=a.a.memo(Q);function Z(e){var t=e.town,n=a.a.useMemo((function(){return t.entity}),[t]);return a.a.useMemo((function(){var e=n.titles;return Object.keys(e).map((function(t){return Object(G.jsxs)("div",{children:[Object(G.jsx)("h4",{className:"TabsContentTitle",children:t}),null==e[t]?Object(G.jsx)("center",{children:"N/A"}):Object(G.jsx)(B,{type:"adventurer",actorID:e[t].id})]})}))}),[n])}var $=a.a.memo(Z);function ee(e){var t=e.actorID,n=e.type,r=a.a.useContext(W).world,i=a.a.useMemo((function(){return r.chronicles.getActor(n,t)}),[n,t,r]),o=a.a.useMemo((function(){return i.years.reduce((function(e,t){var n=i.getYear(t).map((function(e){var t=e.event,n=t.actors.reduce((function(e,t,n){var r="{".concat(n,"}");return e.forEach((function(n,a){n===r&&(e[a]=Object(G.jsx)(B,{type:t.type,actorID:t.id}))})),e}),t.description.split(" "));return Object(G.jsx)("li",{children:n.map((function(e){return"string"!==typeof e?e:" ".concat(e," ")}))},"event".concat(t.description))})).reverse();return e.push(Object(G.jsxs)("div",{children:[Object(G.jsxs)("h4",{className:"TabsContentTitle",children:["Year: ",t]}),Object(G.jsx)("ul",{children:n})]},"year-".concat(t))),e}),[]).reverse()}),[i]);return Object(G.jsx)("div",{children:o})}var te=a.a.memo(ee);n(63);function ne(e){var t=e.town,n=a.a.useMemo((function(){return[{label:"History",content:Object(G.jsx)(te,{type:"town",actorID:t.id})},{label:"Nobles",content:Object(G.jsx)(V,{town:t})},{label:"Titles",content:Object(G.jsx)($,{town:t})}]}),[t]);return Object(G.jsxs)(K,Object(c.a)(Object(c.a)({},e),{},{children:[Object(G.jsxs)("header",{className:"DialogHeader",children:[Object(G.jsx)("img",{width:"50",height:"50",className:"TownDialogHeraldry",alt:"".concat(t.label," Heraldry"),src:"http://armoria.herokuapp.com/png/50/".concat(t.id,"?shield=french")}),Object(G.jsxs)("div",{children:[Object(G.jsx)("h2",{className:"TownDialogHeaderTitle",children:t.label}),Object(G.jsx)("h3",{className:"TownDialogHeaderSubtitle",children:Object(G.jsx)(B,{type:"culture",actorID:t.entity.culture.id})})]})]}),Object(G.jsx)("div",{className:"DialogContent",children:Object(G.jsx)(q,{tabs:n})})]}))}var re=a.a.memo(ne),ae=(n(64),n(31));function ie(e){var t=e.adventurer,n=a.a.useContext(W).world,r=a.a.useMemo((function(){return new ae.ToWords}),[]),i=a.a.useMemo((function(){return t.entity}),[t]),o=a.a.useMemo((function(){var e=i.gender===y.genders.MALE?"He":"She",t=r.convert(i.getAge(n.year)).toLowerCase();return Object(G.jsxs)("p",{children:[e," is ",t," years old, born on in ",n.year," and is from the"," ",Object(G.jsx)(B,{type:"culture",actorID:i.culture.id})," civilization."]})}),[i,r,n]),c=a.a.useMemo((function(){if(0!==i.parents.length){var e=i.gender===y.genders.MALE?"He is":"She is",t=i.gender===y.genders.MALE?"son":"daughter";return Object(G.jsxs)("p",{children:[e," the ",t," of"," ",Object(G.jsx)(B,{type:"adventurer",actorID:i.father.id})," and"," ",Object(G.jsx)(B,{type:"adventurer",actorID:i.mother.id}),"."]})}}),[i]),s=a.a.useMemo((function(){var e=i.gender===y.genders.MALE?"He is":"She is",t=[];null!=i.spouse&&t.push(Object(G.jsxs)("span",{children:[e," married to"," ",Object(G.jsx)(B,{type:"adventurer",actorID:i.spouse.id})]}));var n=i.children.map((function(e){return Object(G.jsx)(B,{type:"adventurer",actorID:e.id})}));return n.length>0&&t.push(Object(G.jsxs)("span",{children:[" ","and has ",r.convert(i.children.length).toLowerCase()," ",1===n.length?"child":"children"]})),0===t.length?null:Object(G.jsxs)("p",{children:[t,"."]})}),[i,r]);return Object(G.jsxs)(G.Fragment,{children:[o,c,s,Object(G.jsxs)("p",{children:[i.appearance,"."]}),Object(G.jsxs)("p",{children:[i.bodyAttributes,"."]}),Object(G.jsxs)("p",{children:[i.soulAttributes,"."]}),Object(G.jsxs)("p",{children:[i.facets,"."]})]})}var oe=a.a.memo(ie);function ce(e){var t=e.adventurer;return a.a.useMemo((function(){return[{name:"Spouse",adventurers:null==t.entity.spouse?[]:[t.entity.spouse]},{name:"Children",adventurers:t.entity.children},{name:"Parents",adventurers:t.entity.parents},{name:"Siblings",adventurers:t.entity.siblings},{name:"Grandparents",adventurers:t.entity.grandparents},{name:"Uncle/Aunties",adventurers:t.entity.piblings},{name:"Cousins",adventurers:t.entity.cousins}].reduce((function(e,t){return e.push(Object(G.jsxs)("div",{children:[Object(G.jsx)("h3",{className:"TabsContentTitle",children:t.name}),0===t.adventurers.length?Object(G.jsx)("center",{children:"N/A"}):Object(G.jsx)("ul",{children:t.adventurers.map((function(e){return Object(G.jsx)("li",{children:Object(G.jsx)(B,{type:"adventurer",actorID:e.id})})}))})]},"family-".concat(t.name))),e}),[])}),[t])}var se=a.a.memo(ce);function le(e){var t=e.adventurer,n=a.a.useMemo((function(){return[{label:"Info",content:Object(G.jsx)(oe,{adventurer:t})},{label:"History",content:Object(G.jsx)(te,{type:"adventurer",actorID:t.id})},{label:"Family",content:Object(G.jsx)(se,{adventurer:t})}]}),[t]);return Object(G.jsxs)(K,Object(c.a)(Object(c.a)({},e),{},{children:[Object(G.jsx)("header",{className:"DialogHeader",children:Object(G.jsx)("div",{children:Object(G.jsx)("h2",{className:"TownDialogHeaderTitle",children:t.label})})}),Object(G.jsx)("div",{className:"DialogContent",children:Object(G.jsx)(q,{tabs:n})})]}))}var ue=a.a.memo(le);function de(e){var t=e.culture,n=a.a.useMemo((function(){return t.entity}),[t]);return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)("div",{children:[Object(G.jsx)("h3",{className:"TabsContentTitle",children:"Ethics"}),Object(G.jsx)("p",{children:n.ethics.toString()})]}),Object(G.jsxs)("div",{children:[Object(G.jsx)("h3",{className:"TabsContentTitle",children:"Beliefs"}),Object(G.jsx)("p",{children:n.beliefs.toString()})]})]})}var he=a.a.memo(de);function fe(e){var t=e.culture,n=a.a.useMemo((function(){return t.entity}),[t]);return a.a.useMemo((function(){var e=n.towns;return 0===e.length?Object(G.jsx)("center",{children:"N/A"}):Object(G.jsx)("ul",{children:e.map((function(e){return Object(G.jsx)("li",{children:Object(G.jsx)(B,{type:"town",actorID:e.id})})}))})}),[n])}var ve=a.a.memo(fe);function ge(e){var t=e.culture,n=a.a.useMemo((function(){return t.entity}),[t]);return a.a.useMemo((function(){var e=n.titles;return Object.keys(e).map((function(t){return Object(G.jsxs)("div",{children:[Object(G.jsx)("h4",{className:"TabsContentTitle",children:t}),null==e[t]?Object(G.jsx)("center",{children:"N/A"}):Object(G.jsx)(B,{type:"adventurer",actorID:e[t].id})]})}))}),[n])}var me=a.a.memo(ge);function be(e){var t=e.culture,n=a.a.useMemo((function(){return t.entity}),[t]);return a.a.useMemo((function(){var e=n.world.cultures;return 1===e.length?"N/A":Object(G.jsx)("ul",{children:e.reduce((function(e,t){return t===n||e.push(Object(G.jsxs)("li",{children:[Object(G.jsx)(B,{type:"culture",actorID:t.id}),":"," ",n.getOpinion(t)]})),e}),[])})}),[n])}var ye=a.a.memo(be);function je(e){var t=e.culture,n=a.a.useMemo((function(){return[{label:"History",content:Object(G.jsx)(te,{type:"culture",actorID:t.id})},{label:"Info",content:Object(G.jsx)(he,{culture:t})},{label:"Titles",content:Object(G.jsx)(me,{culture:t})},{label:"Towns",content:Object(G.jsx)(ve,{culture:t})},{label:"Diplo",content:Object(G.jsx)(ye,{culture:t})}]}),[t]);return Object(G.jsxs)(K,Object(c.a)(Object(c.a)({},e),{},{children:[Object(G.jsxs)("header",{className:"DialogHeader",children:[Object(G.jsx)("img",{width:"50",height:"50",className:"TownDialogHeraldry",alt:"".concat(t.label," Heraldry"),src:"http://armoria.herokuapp.com/png/50/".concat(t.id,"?shield=french")}),Object(G.jsx)("div",{children:Object(G.jsx)("h2",{className:"TownDialogHeaderTitle",children:t.label})})]}),Object(G.jsx)("div",{className:"DialogContent",children:Object(G.jsx)(q,{tabs:n})})]}))}var pe=a.a.memo(je);function _e(){var e=a.a.useRef(),t=a.a.useState(),n=Object(o.a)(t,2),r=n[0],i=n[1],c=a.a.useState(),s=Object(o.a)(c,2),l=s[0],u=s[1];a.a.useLayoutEffect((function(){var t=new R({canvas:e.current,seed:"idrinkandiknowthingsd",onTownSelection:function(e){u({entity:e,type:"town"})}});window.world=t,i(t)}),[]);var d=a.a.useCallback((function(){u(null)}),[]),h=a.a.useMemo((function(){if(null!=l){var e=l.type,t=l.entity;switch(e){case"town":return Object(G.jsx)(re,{town:t,onClose:d});case"adventurer":return Object(G.jsx)(ue,{adventurer:t,onClose:d});case"culture":return Object(G.jsx)(pe,{culture:t,onClose:d});default:return null}}}),[l,d]);return Object(G.jsx)("div",{className:"App",children:Object(G.jsxs)(W.Provider,{value:{world:r,setSelectedActorInfo:u},children:[Object(G.jsx)(Y,{}),h,Object(G.jsx)("canvas",{ref:e,width:"2000",height:"2000"})]})})}var Oe=document.getElementById("root");Object(i.createRoot)(Oe).render(Object(G.jsx)(r.StrictMode,{children:Object(G.jsx)(_e,{})}))}},[[81,1,2]]]);
//# sourceMappingURL=main.98a8d15d.chunk.js.map